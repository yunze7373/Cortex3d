services:
  instantmesh:
    build:
      context: .
      dockerfile: Dockerfile
    image: cortex3d-instantmesh:latest
    container_name: cortex3d-dev
    working_dir: /workspace
    volumes:
      - ./:/workspace
      - hf-cache:/root/.cache/huggingface
    shm_size: "8gb"
    stdin_open: true
    tty: true
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

  trellis:
    build:
      context: .
      dockerfile: Dockerfile.trellis
    image: cortex3d-trellis:latest
    container_name: cortex3d-trellis
    working_dir: /workspace
    volumes:
      - ./:/workspace
      - hf-cache:/root/.cache/huggingface
    shm_size: "16gb"
    stdin_open: true
    tty: true
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

  hunyuan3d:
    build:
      context: .
      dockerfile: Dockerfile.hunyuan3d
    image: cortex3d-hunyuan3d:latest
    container_name: cortex3d-hunyuan3d
    working_dir: /workspace
    volumes:
      - ./:/workspace
      - hf-cache:/root/.cache/huggingface
    shm_size: "16gb"
    stdin_open: true
    tty: true
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]

volumes:
  hf-cache:

